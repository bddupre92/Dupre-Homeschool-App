(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9320:function(e,r,t){Promise.resolve().then(t.bind(t,4733))},4733:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return ProfilePage}});var o=t(7437),s=t(2265),a=t(2720);let DefaultErrorFallback=e=>{let{error:r,resetErrorBoundary:t}=e;return(0,o.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 my-4 max-w-xl mx-auto",children:[(0,o.jsxs)("div",{className:"flex items-center mb-4",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-500 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,o.jsx)("h2",{className:"text-lg font-semibold text-red-800",children:"Something went wrong"})]}),(0,o.jsx)("p",{className:"text-red-700 mb-4",children:"We're sorry, but we encountered an unexpected error. Our team has been notified."}),(0,o.jsxs)("details",{className:"mb-4",children:[(0,o.jsx)("summary",{className:"text-red-700 cursor-pointer",children:"Error details"}),(0,o.jsx)("pre",{className:"mt-2 p-2 bg-red-100 rounded text-red-900 text-sm overflow-auto",children:null==r?void 0:r.toString()})]}),(0,o.jsx)("button",{onClick:t,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Try again"})]})};var n=t(5252),l=t(1045),i=t(9878),d=t(9498),u=t(2496),c=t(8153),h=t(9043);let m=u.Z.create({container:{backgroundColor:"white",borderRadius:12,padding:24,width:"100%",maxWidth:500,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},title:{fontSize:24,fontWeight:"bold",marginBottom:24,textAlign:"center"},errorContainer:{backgroundColor:"#fee2e2",borderRadius:8,padding:12,marginBottom:16},errorText:{color:"#b91c1c",fontSize:14},successContainer:{backgroundColor:"#ecfdf5",borderRadius:8,padding:12,marginBottom:16},successText:{color:"#065f46",fontSize:14},formGroup:{marginBottom:16},label:{fontSize:16,fontWeight:"bold",marginBottom:8},input:{borderWidth:1,borderColor:"#ddd",borderRadius:8,padding:12,fontSize:16},inputError:{borderColor:"#ef4444"},fieldError:{color:"#ef4444",fontSize:14,marginTop:4},passwordSection:{marginTop:16,marginBottom:16,paddingTop:16,borderTopWidth:1,borderTopColor:"#eee"},sectionTitle:{fontSize:18,fontWeight:"bold",marginBottom:16},button:{backgroundColor:"#4f46e5",borderRadius:8,padding:16,alignItems:"center",marginTop:8},buttonDisabled:{backgroundColor:"#a5a5a5"},buttonText:{color:"white",fontSize:16,fontWeight:"bold"}}),p=function(e){let{fallback:r,onError:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.displayName||e.name||"Component",WrappedComponent=n=>{let[l,i]=s.useState(null),d=r||(0,o.jsx)(DefaultErrorFallback,{error:l,resetErrorBoundary:()=>{i(null)}});return(0,o.jsx)(a.default,{fallback:d,onError:(e,r)=>{i(e),t&&t(e,r)},children:(0,o.jsx)(e,{...n})})};return WrappedComponent.displayName="withErrorBoundary(".concat(n,")"),WrappedComponent}(e=>{let{onSuccess:r}=e,{user:t}=(0,h.useAuth)(),[a,u]=(0,s.useState)((null==t?void 0:t.displayName)||""),[p,x]=(0,s.useState)((null==t?void 0:t.email)||""),[f,g]=(0,s.useState)(""),[y,w]=(0,s.useState)(""),[b,j]=(0,s.useState)(""),[E,v]=(0,s.useState)(!1),[P,C]=(0,s.useState)(null),[S,Z]=(0,s.useState)(null),[N,k]=(0,s.useState)({});(0,s.useEffect)(()=>{t&&(u(t.displayName||""),x(t.email||""))},[t]);let validateForm=()=>{let e={};return a.trim()||(e.displayName="Display name is required"),p.trim()?/\S+@\S+\.\S+/.test(p)||(e.email="Email is invalid"):e.email="Email is required",y&&(f||(e.currentPassword="Current password is required to set a new password"),y.length<6&&(e.newPassword="Password must be at least 6 characters"),y!==b&&(e.confirmPassword="Passwords do not match")),p===(null==t?void 0:t.email)||f||(e.currentPassword="Current password is required to change email"),k(e),0===Object.keys(e).length},handleUpdateProfile=async()=>{if(validateForm()&&t)try{if(v(!0),C(null),Z(null),(p!==t.email||y)&&f){let e=c.w9.credential(t.email||"",f);await (0,c.aF)(t,e)}a!==t.displayName&&await (0,c.ck)(t,{displayName:a}),p!==t.email&&await (0,c.s)(t,p),y&&await (0,c.gQ)(t,y),Z("Profile updated successfully!"),g(""),w(""),j(""),r()}catch(e){console.error("Error updating profile:",e),"auth/requires-recent-login"===e.code?C("For security reasons, please log out and log back in to make these changes."):"auth/email-already-in-use"===e.code?C("This email is already in use by another account."):"auth/invalid-email"===e.code?C("The email address is not valid."):"auth/weak-password"===e.code?C("The password is too weak."):"auth/wrong-password"===e.code?C("The current password is incorrect."):C("Failed to update profile. Please try again later.")}finally{v(!1)}};return t?(0,o.jsxs)(n.Z,{style:m.container,children:[(0,o.jsx)(l.Z,{style:m.title,children:"Edit Profile"}),P&&(0,o.jsx)(n.Z,{style:m.errorContainer,children:(0,o.jsx)(l.Z,{style:m.errorText,children:P})}),S&&(0,o.jsx)(n.Z,{style:m.successContainer,children:(0,o.jsx)(l.Z,{style:m.successText,children:S})}),(0,o.jsxs)(n.Z,{style:m.formGroup,children:[(0,o.jsx)(l.Z,{style:m.label,children:"Display Name"}),(0,o.jsx)(i.Z,{style:[m.input,N.displayName&&m.inputError],value:a,onChangeText:u,placeholder:"Enter your display name",autoCapitalize:"words"}),N.displayName&&(0,o.jsx)(l.Z,{style:m.fieldError,children:N.displayName})]}),(0,o.jsxs)(n.Z,{style:m.formGroup,children:[(0,o.jsx)(l.Z,{style:m.label,children:"Email"}),(0,o.jsx)(i.Z,{style:[m.input,N.email&&m.inputError],value:p,onChangeText:x,placeholder:"Enter your email",keyboardType:"email-address",autoCapitalize:"none"}),N.email&&(0,o.jsx)(l.Z,{style:m.fieldError,children:N.email})]}),(0,o.jsxs)(n.Z,{style:m.passwordSection,children:[(0,o.jsx)(l.Z,{style:m.sectionTitle,children:"Change Password"}),(0,o.jsxs)(n.Z,{style:m.formGroup,children:[(0,o.jsx)(l.Z,{style:m.label,children:"Current Password"}),(0,o.jsx)(i.Z,{style:[m.input,N.currentPassword&&m.inputError],value:f,onChangeText:g,placeholder:"Enter your current password",secureTextEntry:!0}),N.currentPassword&&(0,o.jsx)(l.Z,{style:m.fieldError,children:N.currentPassword})]}),(0,o.jsxs)(n.Z,{style:m.formGroup,children:[(0,o.jsx)(l.Z,{style:m.label,children:"New Password"}),(0,o.jsx)(i.Z,{style:[m.input,N.newPassword&&m.inputError],value:y,onChangeText:w,placeholder:"Enter new password",secureTextEntry:!0}),N.newPassword&&(0,o.jsx)(l.Z,{style:m.fieldError,children:N.newPassword})]}),(0,o.jsxs)(n.Z,{style:m.formGroup,children:[(0,o.jsx)(l.Z,{style:m.label,children:"Confirm New Password"}),(0,o.jsx)(i.Z,{style:[m.input,N.confirmPassword&&m.inputError],value:b,onChangeText:j,placeholder:"Confirm new password",secureTextEntry:!0}),N.confirmPassword&&(0,o.jsx)(l.Z,{style:m.fieldError,children:N.confirmPassword})]})]}),(0,o.jsx)(d.Z,{style:[m.button,E&&m.buttonDisabled],onPress:handleUpdateProfile,disabled:E,children:(0,o.jsx)(l.Z,{style:m.buttonText,children:E?"Updating...":"Update Profile"})})]}):(0,o.jsx)(n.Z,{style:m.container,children:(0,o.jsx)(l.Z,{children:"You must be logged in to view this page."})})},{onError:(e,r)=>{console.error("Error in ProfileForm component:",e,r)}}),handleSuccess=()=>{console.log("Profile form submitted successfully on ProfilePage!")};function ProfilePage(){return(0,o.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-md",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Your Profile"}),(0,o.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,o.jsx)(p,{onSuccess:handleSuccess})})]})}},9043:function(e,r,t){"use strict";t.r(r),t.d(r,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var o=t(7437),s=t(2265),a=t(8153),n=t(994),l=t(9365),i=t(9584),d=t(2601);let u={apiKey:"AIzaSyBNDddgbmDgDjG4K-FuFjkM6FMCB9_zGLk",authDomain:"dupre-homeschool-app.firebaseapp.com",projectId:"dupre-homeschool-app",storageBucket:"dupre-homeschool-app.firebasestorage.app",messagingSenderId:"283384305539",appId:"1:283384305539:web:54981e950614530d5e08b6",measurementId:d.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID},c=(0,n.ZF)(u);(0,l.IH)(c);let h=(0,a.v0)(c);(0,i.cF)(c);let m=(0,s.createContext)({user:null,loading:!0,signOut:async()=>{}}),useAuth=()=>(0,s.useContext)(m),AuthProvider=e=>{let{children:r}=e,[t,n]=(0,s.useState)(null),[l,i]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=(0,a.Aj)(h,e=>{n(e),i(!1)});return()=>e()},[]);let signOut=async()=>{try{await (0,a.w7)(h)}catch(e){console.error("Error signing out:",e)}};return(0,o.jsx)(m.Provider,{value:{user:t,loading:l,signOut},children:r})}},2720:function(e,r,t){"use strict";t.r(r);var o=t(7437);t(2265);var s=t(4740);function DefaultErrorFallback(e){let{error:r,resetErrorBoundary:t}=e;return(0,o.jsxs)("div",{role:"alert",className:"error-boundary-fallback",children:[(0,o.jsx)("h2",{children:"Something went wrong."}),(0,o.jsxs)("details",{children:[(0,o.jsx)("summary",{children:"Error details"}),(0,o.jsx)("pre",{children:r.message})]}),(0,o.jsx)("button",{onClick:t,className:"error-boundary-retry-button",children:"Try again"})]})}r.default=e=>{let{children:r,onError:t=(e,r)=>{console.error("Caught error:",e,r)},fallback:a}=e;return(0,o.jsx)(s.SV,{fallbackRender:e=>{let{error:r,resetErrorBoundary:t}=e;return a?(0,o.jsx)(o.Fragment,{children:a}):(0,o.jsx)(DefaultErrorFallback,{error:r,resetErrorBoundary:t})},onError:t,children:r})}}},function(e){e.O(0,[109,912,721,971,472,744],function(){return e(e.s=9320)}),_N_E=e.O()}]);